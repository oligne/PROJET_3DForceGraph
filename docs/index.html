<head>
    <style> body { margin: 0; } </style>
  
    <script src="//unpkg.com/3d-force-graph"></script>
    <!--<script src="../../dist/3d-force-graph.js"></script>-->
  </head>
  
  <body>
    <div id="3d-graph"></div>
  
    <script>
fetch('datasets/data.json')
  .then(response => response.json())
  .then(fullGraph => {
    const percentageToKeep = 0.5;  // Change ici pour ajuster le pourcentage (0.5 = 50%)

    // Sélection aléatoire d'un sous-ensemble de nœuds
    const shuffledNodes = fullGraph.nodes.sort(() => 0.5 - Math.random());  
    const numNodesToKeep = Math.floor(shuffledNodes.length * percentageToKeep);
    const selectedNodes = shuffledNodes.slice(0, numNodesToKeep);

    // Créer un Set des ID des nœuds sélectionnés pour un accès rapide
    const selectedNodeIds = new Set(selectedNodes.map(node => node.id));

    // Filtrer les liens pour ne garder que ceux entre les nœuds sélectionnés
    const selectedLinks = fullGraph.links.filter(link => 
      selectedNodeIds.has(link.source) && selectedNodeIds.has(link.target)
    );

    // Initialiser le graph avec ces données filtrées
    const graph = ForceGraph3D()(document.getElementById('3d-graph'))
      .graphData({ nodes: selectedNodes, links: selectedLinks })
      .nodeAutoColorBy('type')
      .nodeLabel(node => `${node['Nom du fichier']}: ${node.Extension}`)
      .onNodeClick(node => alert(`Vous avez cliqué sur ${node['Nom du fichier']}`));

    // Ajouter des optimisations de performance
    graph.cooldownTicks(100)
      .d3AlphaDecay(0.02)
      .d3VelocityDecay(0.3)
      .linkWidth(0.3)
      .linkOpacity(0.2);
  })
  .catch(error => console.error('Erreur lors du chargement du fichier JSON :', error));
  

      const Graph = new ForceGraph3D(document.getElementById('3d-graph'))
          .jsonUrl('data.json')
          .nodeLabel('Nom du fichier')
          .nodeAutoColorBy('Dossier');
    </script>
  </body>
  